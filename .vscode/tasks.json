// This file is automatically generated by Teams Toolkit.
// The teamsfx tasks defined in this file require Teams Toolkit version >= 5.0.0.
// See https://aka.ms/teamsfx-tasks for details on how to customize each task.
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "Validate Docker prerequisites",
      "type": "teamsfx",
      "command": "debug-check-prerequisites",
      "args": {
        "prerequisites": [
          "m365Account", // Sign-in prompt for Microsoft 365 account, then validate if the account enables the sideloading permission.
          "portOccupancy" // Validate available ports to ensure those debug ones are not occupied.
        ],
        "portOccupancy": [
          53000, // tab service port
          7071, // backend service port
          9229 // backend inspector port for Node.js debugger
        ]
      }
    },
    {
      "label": "Start Teams App in Docker",
      "dependsOn": [
        "Validate Docker prerequisites",
        "Provision",
        "docker-compose-up"
      ],
      "dependsOrder": "sequence"
    },
    {
      // Create the debug resources.
      // See https://aka.ms/teamsfx-tasks/provision to know the details and how to customize the args.
      "label": "Provision",
      "type": "teamsfx",
      "command": "provision",
      "args": {
        "env": "local"
      }
    },
    {
      "label": "Stop Teams App in Docker",
      "type": "shell",
      "command": "docker compose -f ${workspaceFolder}/compose-debug.yaml down",
      "isBackground": true
    },
    {
      "type": "shell",
      "label": "docker-compose-up",
      "command": "docker compose -f ${workspaceFolder}/compose-debug.yaml up -d",
      "isBackground": true,
      "options": {
        "env": {
          "HOME": "${userHome}"
        }
      }
    }
  ]
}
